<div class="nav-title">User Settings</div>

<div class="main-content">
  <div class="all-sections">

    <div class="section-label" ng-click="expand1 = !expand1">
        Account
        <i ng-class="{'icon-down': expand1, 'icon-right': !expand1}"></i>
    </div>
    <div class="section email" collapse="!expand1">
    	<div class="setting-item">
      	<div class="half-column">
      		<label>Your Email</label>
      		<p>{{user.email}}</p>
    		</div>
      	<div class="half-column value" ng-hide="editing.email">
          <button type="button" ng-click="edit('email')">Change</button>
        </div>
        <div class="half-column value" ng-show="editing.email">
          <form name="emailForm">
            <div class="form-group" ng-class="{'has-error': emailForm.$invalid}">
              <input type="email" ng-model="edited.email" class="form-control"/>
            </div>
          </form>
          <div class="buttons">
            <button type="button" ng-click="cancelEdit('email')">Cancel</button>
            <button type="button" class="main-action" ng-click="saveEdit('email', emailForm)">Save</button>
          </div>
        </div>
    	</div>
    	<div class="setting-item">
      	<div class="half-column"><label>Your Password</label></div>
      	<div class="half-column value" ng-hide="editing.password">
          <a class="change-password" ng-click="edit('password')">Change</a>
        </div>
        <div class="half-column value" ng-show="editing.password">
          <p class="help">Enter a new password.</p>
          <input type="password" ng-model="edited.password" class="form-control"/>
          <div class="buttons">
            <button type="button" ng-click="cancelEdit('password')">Cancel</button>
            <button type="button" class="main-action" ng-click="saveEdit('password')">Save</button>
          </div>
        </div>
    	</div>
    	<div class="setting-item">
      	<div class="main-column">
          <label>Receive email notifications?</label>
          <div class="summary">Check the circle to get updates on posts you create or follow. You can also change this for each post individually.</div>
        </div>
      	<div class="side-column">
          <input type="checkbox" ng-model="user.send_email_preference" ng-click="toggle('send_email_preference')"/>
        </div>
    	</div>
      <div class="setting-item">
        <div class="main-column">
          <label>Receive email digests?</label>
          <div class="summary">Choose how frequently you would like to receive email about new activity in your communities.</div>
        </div>
        <div class="side-column">
          <select ng-model="user.settings.digest_frequency" ng-change="toggle('digest_frequency', true)">
            <option value="daily">Daily</option>
            <option value="weekly">Weekly</option>
            <option value="never">Never</option>
          </select>
        </div>
      </div>
    </div>

    <div class="section-label" ng-click="expand2 = !expand2">
        Communities
        <i ng-class="{'icon-down': expand2, 'icon-right': !expand2}"></i>
    </div>
    <div class="section communities" collapse="!expand2">
      <div class="setting-item" ng-repeat="membership in user.memberships track by $index">
        <div class="main-column">
          <label><a ui-sref="community.posts({community: membership.community.slug})">{{membership.community.name}}</a></label>
          <div class="summary">Joined: {{membership.created_at | date:'longDate'}}</div>
        </div>
        <div class="side-column"><a ng-click="leaveCommunity(membership.community_id, $index)">Leave</a></div>
      </div>
    </div>
    <div class="section" collapse="!expand2">
      <div ng-show="!user.memberships.length">
        <div class="setting-item">
          <div class="full-column">
            <p>You do not belong to any communities yet. <a ng-click="joinCommunity()">Join a community</a></p>
          </div>
        </div>
      </div>
    </div>

    <div class="section-label" ng-click="expand3 = !expand3">
        Payment Details
        <i ng-class="{'icon-down': expand3, 'icon-right': !expand3}"></i>
    </div>
    <div class="section" collapse="!expand3">
      <div class="setting-item">
        <div class="full-column">
          <p>You do not belong to any communities that require a membership fee.</p>
        </div>
      </div>
    </div>

  </div>
</div>
